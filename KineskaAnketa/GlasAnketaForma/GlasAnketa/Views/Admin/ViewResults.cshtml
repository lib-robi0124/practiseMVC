@model ResultsVM
@{
    ViewData["Title"] = "View Results";
}

<div class="admin-container">
    <div class="admin-header">
        <h1>📊 View Results</h1>
        <p>Survey results and analytics</p>
        <div class="user-info">
            <small>Logged in as: <strong>@Context.Session.GetString("UserName")</strong></small> |
            <a href="@Url.Action("Index", "Admin")" class="btn btn-secondary">← Back to Dashboard</a> |
            <a href="@Url.Action("Logout", "Account")" class="text-danger">Logout</a>
        </div>
    </div>

    <div class="alert alert-info">
        <h4>📈 Results Dashboard</h4>
        <p>View and analyze survey responses. This section will show:</p>
        <ul>
            <li>Response rates and statistics</li>
            <li>Individual answer details</li>
            <li>Analytics and trends</li>
            <li>Export capabilities</li>
        </ul>
    </div>

    <div class="admin-content">
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3>Form Selection</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label>Select Questionnaire Form:</label>
                            <select class="form-control" id="formSelector">
                                <option value="1">Form 1: Општо задоволство</option>
                                <option value="2">Form 2: Обврска кон компанијата</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="loadResults()">Load Results</button>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3>Quick Stats</h3>
                    </div>
                    <div class="card-body">
                        <div class="stat-item">
                            <h4>Total Responses</h4>
                            <div class="stat-number">0</div>
                        </div>
                        <div class="stat-item">
                            <h4>Completion Rate</h4>
                            <div class="stat-number">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h3>Response Details</h3>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <p>No response data available yet. Responses will appear here once users start submitting questionnaires.</p>
                </div>

                @if (Model?.Answers != null && Model.Answers.Any())
                {
                    <table class="table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Question</th>
                                <th>Answer</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var answer in Model.Answers)
                            {
                                <tr>
                                    <td>User @answer.UserId</td>
                                    <td>Question @answer.QuestionId</td>
                                    <td>
                                        @if (answer.ScaleValue.HasValue)
                                        {
                                            <span>Scale: @answer.ScaleValue</span>
                                        }
                                        else if (!string.IsNullOrEmpty(answer.TextValue))
                                        {
                                            <span>Text: @answer.TextValue</span>
                                        }
                                        else
                                        {
                                            <span class="text-muted">No answer</span>
                                        }
                                    </td>
                                    <td>@answer.AnsweredDate.ToString("MMM dd, yyyy")</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <div class="text-center py-4">
                        <div style="font-size: 3em;">📭</div>
                        <h4>No Responses Yet</h4>
                        <p class="text-muted">Survey responses will appear here once employees start submitting their answers.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<style>
    .stat-item {
        text-align: center;
        padding: 15px;
    }

    .stat-number {
        font-size: 2em;
        font-weight: bold;
        color: #007bff;
    }

    .table {
        width: 100%;
        border-collapse: collapse;
    }

        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

    .card {
        border: 1px solid #e1e8ed;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .card-header {
        background-color: #f8f9fa;
        padding: 15px 20px;
        border-bottom: 1px solid #e1e8ed;
    }

    .card-body {
        padding: 20px;
    }

    .form-control {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 10px;
    }
</style>

<script>
    function loadResults() {
        const formId = document.getElementById('formSelector').value;
        alert('Loading results for form ' + formId + '... (This feature is under development)');
        // In the future, this would make an AJAX call to load the results
    }
</script>
