# Evolution Form / Questionnaire App (ASP.NET Core MVC)
**This project is a **.NET Core MVC** application for managing **evolution forms / questionnaires** inside a company.  
**It demonstrates role-based access (Admin, Manager, Employee), CRUD operations, DTO usage, and a simple logging-in system.**

## Application requirements

### Models

- **User**: This model represents a employee in the system. It includes properties like `Id`, `FullName`, `OU`, `Role`. The `Role` indicates the type of the user has `Admin`, `Manager`, `Employee`.

- **Questionnaire**: This model represents a form of questions to be answered. It includes properties like `Id`, `TitlePage`, `ICollection<QuestionItem>`, `QuestionItemStatus`. 

- **QuestionItem**: This model represents a questions available for answers.

- **Role**: This Enum represents a a Role in Company. It includes properties like `Admin`, `Manager`, `Employee`..

---
                  ┌───────────────────────────────┐
                  │          User Roles           │
                  │                               │
                  │   Admin | Manager | Employee  │
                  └───────────────────────────────┘
                               │
                               ▼
                  ┌───────────────────────────────┐
                  │           Controllers          │
                  │                               │
                  │ AccountController   (Login)   │
                  │ QuestionnaireController (CRUD)│
                  │ AnswerController   (Submit)   │
                  └───────────────────────────────┘
                               │
                ┌──────────────┼──────────────────┐
                ▼              ▼                  ▼
   ┌─────────────────┐   ┌───────────────┐   ┌─────────────────┐
   │       Views      │   │     Models    │   │      DTOs        │
   │ (Razor Pages)    │   │ (Business Obj)│   │ (Transport Obj) │
   │                  │   │               │   │                 │
   │ Login.cshtml     │   │ User          │   │ UserDto         │
   │ Questionnaire/   │   │ Questionnaire │   │ QuestionnaireDto│
   │   Index.cshtml   │   │ QuestionItem  │   │ QuestionItemDto │
   │ Answer/Index     │   │ Answer        │   │ AnswerDto       │
   └─────────────────┘   └───────────────┘   └─────────────────┘
                │              │                  │
                └───────┬──────┴───────┬─────────┘
                        │              │
                        ▼              ▼
                ┌───────────────────────────────┐
                │           Services             │
                │                               │
                │ IProductService → ProductSrv   │
                │ IQuestionnaireService → QSrv   │
                │ IUserService → UserSrv         │
                └───────────────────────────────┘
                               │
                               ▼
                ┌───────────────────────────────┐
                │         Repository Layer       │
                │                               │
                │ IQuestionnaireRepository       │
                │ IUserRepository                │
                │ IAnswerRepository              │
                └───────────────────────────────┘
                               │
                               ▼
                ┌───────────────────────────────┐
                │             Database           │
                │                               │
                │   Tables:                     │
                │   - Users                     │
                │   - Questionnaires            │
                │   - QuestionItems             │
                │   - Answers                   │
                └───────────────────────────────┘
**User (Admin/Manager/Employee) logs in → `AccountController`.**

-**Based on `Role`:**

**`Admin` → CRUD on Questionnaires via `QuestionnaireController`.**

**`Manager` → Views assigned questionnaires.**

**`Employee` → Answers questionnaire via `AnswerController`.**

**Controllers talk to Services, which contain business logic.**

**Services use Repositories to get/save data in the DB.**

**Views (Razor Pages) render data (HTML + forms) for browser users.**

**DTOs are used for transferring clean data between controllers ↔ views/services.**
## 📌 Features

- **Authentication & Roles**
  - Users log in with basic URL-based login (`/Login?userId=1` for demo).
  - Roles: `Admin`, `Manager`, `Employee`.

- **Admin**
  - Full CRUD for Questionnaires (create, edit, delete, view).
  - Assign questionnaires to employees.
  - See employee responses.

- **Manager**
  - View forms assigned to their OU/Company.
  - Track questionnaire status.

- **Employee**
  - Answer questions:
    - **Radio question** (Yes/No).
    - **Scale question** (1–10).
    - **Text question** (max 255 characters).

---
## 📦 Project Structure
EvolutionFormsApp/
│
├── Controllers/
│   ├── AccountController.cs
│   ├── QuestionnaireController.cs
│   └── AnswerController.cs
│
├── Models/
│   ├── User.cs
│   ├── Questionnaire.cs
│   ├── QuestionItem.cs
│   ├── Answer.cs
│   └── Enums.cs
│
├── DTOs/
│   ├── UserDto.cs
│   ├── QuestionnaireDto.cs
│   ├── QuestionItemDto.cs
│   └── AnswerDto.cs
│
├── Services/
│   ├── Interfaces/
│   │   ├── IUserService.cs
│   │   ├── IQuestionnaireService.cs
│   │   └── IAnswerService.cs
│   └── Implementations/
│       ├── UserService.cs
│       ├── QuestionnaireService.cs
│       └── AnswerService.cs
│
├── Data/
│   ├── AppDbContext.cs
│   ├── StaticDb.cs
│   ├── Repositories/
│   │   ├── IUserRepository.cs
│   │   ├── IQuestionnaireRepository.cs
│   │   ├── IAnswerRepository.cs
│   │   ├── UserRepository.cs
│   │   ├── QuestionnaireRepository.cs
│   │   └── AnswerRepository.cs
│
├── Views/
│   ├── Account/
│   │   └── Login.cshtml
│   ├── Questionnaire/
│   │   ├── Index.cshtml
│   │   ├── Create.cshtml
│   │   ├── Edit.cshtml
│   │   └── Details.cshtml
│   └── Answer/
│       ├── Index.cshtml
│       └── ThankYou.cshtml
│
├── wwwroot/
│   ├── css/
│   ├── js/
│   └── lib/
│
├── Program.cs
├── appsettings.json
└── Startup.cs (if not using minimal hosting model)



## 📦 Project Structure
**Models**
User.cs
```cs
public class User
{
    public int Id { get; set; }
    public int CompanyId { get; set; }
    public string FullName { get; set; }
    public string OU { get; set; } // Organizational Unit
    public Role Role { get; set; }
}
``
Questionnaire.cs
````cs
public class Questionnaire
{
    public int Id { get; set; }
    public string Title { get; set; }
    public List<QuestionItem> QuestionItems { get; set; } = new();
    public string Status { get; set; } // Draft, Published, Closed
}

QuestionItem.cs
````cs
public class QuestionItem
{
    public int Id { get; set; }
    public string QuestionText { get; set; }
    public QuestionType Type { get; set; }
}
Answer.cs
````cs
public class Answer
{
    public int Id { get; set; }
    public int QuestionnaireId { get; set; }
    public int QuestionId { get; set; }
    public int UserId { get; set; }
    public string Response { get; set; }
}

Enums.cs
````cs
public enum Role
{
    Admin,
    Manager,
    Employee
}

public enum QuestionType
{
    Text,   // 255 char
    Radio,  // Yes/No
    Scale   // 1-10
}
````

##**DTOs **
UserDto.cs
QuestionnaireDto.cs
QuestionItemDto.cs
AnswerDto.cs


##**Controllers**
AccountController.cs
````cs
public class AccountController : Controller
{
    public IActionResult Login(int userId)
    {
        var user = StaticDb.Users.FirstOrDefault(u => u.Id == userId);
        if (user == null) return NotFound();

        HttpContext.Session.SetInt32("UserId", user.Id);
        HttpContext.Session.SetString("Role", user.Role.ToString());

        return RedirectToAction("Index", "Questionnaire");
    }
}
````
QuestionnaireController.cs
````cs
[Authorize(Roles = "Admin,Manager")]
public class QuestionnaireController : Controller
{
    public IActionResult Index() => View(StaticDb.Questionnaires);

    [Authorize(Roles = "Admin")]
    public IActionResult Create() => View();

    [HttpPost, Authorize(Roles = "Admin")]
    public IActionResult Create(QuestionnaireDto dto)
    {
        var q = new Questionnaire
        {
            Id = StaticDb.Questionnaires.Count + 1,
            Title = dto.Title,
            QuestionItems = dto.Questions.Select(qi => new QuestionItem {
                QuestionText = qi.QuestionText,
                Type = qi.Type
            }).ToList(),
            Status = "Draft"
        };
        StaticDb.Questionnaires.Add(q);
        return RedirectToAction("Index");
    }
}

AnswerController.cs
````cs
[Authorize(Roles = "Employee")]
public class AnswerController : Controller
{
    public IActionResult Index(int questionnaireId)
    {
        var questionnaire = StaticDb.Questionnaires.FirstOrDefault(q => q.Id == questionnaireId);
        return View(questionnaire);
    }

    [HttpPost]
    public IActionResult Submit(List<AnswerDto> answers)
    {
        foreach (var ans in answers)
        {
            StaticDb.Answers.Add(new Answer
            {
                Id = StaticDb.Answers.Count + 1,
                QuestionnaireId = 1,
                QuestionId = ans.QuestionId,
                UserId = HttpContext.Session.GetInt32("UserId").Value,
                Response = ans.AnswerText
            });
        }
        return RedirectToAction("ThankYou");
    }

    public IActionResult ThankYou() => View();
}

##**Views**
## Views/Account/Login.cshtml
````cs
<h2>Login</h2>
<form method="get" action="/Account/Login">
    <label>User ID:</label>
    <input type="number" name="userId" />
    <button type="submit">Login</button>
</form>
##Views/Questionnaire/Index.cshtml
<h2>All Questionnaires</h2>
<table>
@foreach (var q in Model)
{
    <tr>
        <td>@q.Title</td>
        <td>@q.Status</td>
        <td><a href="/Questionnaire/Details/@q.Id">Details</a></td>
    </tr>
}
</table>

Questionnaire/Edit.cshtml

##Views/Answer/Index.cshtml
<h2>@Model.Title</h2>
<form method="post" action="/Answer/Submit">
@foreach (var q in Model.QuestionItems)
{
    <p>@q.QuestionText</p>
    @if (q.Type == QuestionType.Radio)
    {
        <input type="radio" name="answers[@q.Id].AnswerText" value="Yes" /> Yes
        <input type="radio" name="answers[@q.Id].AnswerText" value="No" /> No
        <input type="hidden" name="answers[@q.Id].QuestionId" value="@q.Id" />
    }
    else if (q.Type == QuestionType.Scale)
    {
        <input type="number" name="answers[@q.Id].AnswerText" min="1" max="10" />
        <input type="hidden" name="answers[@q.Id].QuestionId" value="@q.Id" />
    }
    else
    {
        <input type="text" name="answers[@q.Id].AnswerText" maxlength="255" />
        <input type="hidden" name="answers[@q.Id].QuestionId" value="@q.Id" />
    }
}
<button type="submit">Submit</button>
</form>


### Requirements 

- **User Login**: Even though you're not using authentication, you still need a way to identify users. You could create a simple login page where users enter their `CardNumber` or you can use `Email`. Once they're logged in, you can store their `User` object in a session variable or use ViewData to pass the user information between different requests.

- **View Movies**: Create a page that displays a list or grid of all the movies. Each item should show basic information about the movie, such as the title and genre. You could also show whether the movie is currently available for rent.

- **Movie Details**: Each movie in the list should be clickable and lead to a detailed page for that movie. This page should display all the information about the movie, such as the title, genre, language, release date, length, age restriction, and quantity available.

- **Rent Movie**: If a movie is available (i.e., the quantity is more than 0), show a "Rent" button on the movie's detail page. When this button is clicked, create a new `Rental` object, link it to the current user and the movie. Don't forget to decrease the quantity of the movie.

 - **Return Movie**: Create a page that shows all the movies currently rented by the user. Each item should have a "Return" button. When this button is clicked, find the corresponding `Rental` object in the `Rentals` list using the `Rental.Id`, `Rental.UserId`, and `Rental.MovieId`. Set the `ReturnedOn` property of the `Rental` object to the current date and time. Also, find the corresponding `Movie` object using `Rental.MovieId` and increase the `Quantity` of the `Movie` object by 1, indicating that the movie has been returned and is now available for rent again.



